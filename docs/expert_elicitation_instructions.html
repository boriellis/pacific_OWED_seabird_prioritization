<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>expert_elicitation_instructions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="expert_elicitation_instructions_files/libs/clipboard/clipboard.min.js"></script>
<script src="expert_elicitation_instructions_files/libs/quarto-html/quarto.js"></script>
<script src="expert_elicitation_instructions_files/libs/quarto-html/popper.min.js"></script>
<script src="expert_elicitation_instructions_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="expert_elicitation_instructions_files/libs/quarto-html/anchor.min.js"></script>
<link href="expert_elicitation_instructions_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="expert_elicitation_instructions_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="expert_elicitation_instructions_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="expert_elicitation_instructions_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="expert_elicitation_instructions_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">




<section id="rare-california-seabird-distribution-expert-elicitation-exercise" class="level1">
<h1><strong>Rare California Seabird Distribution Expert Elicitation Exercise</strong></h1>
<p>Thank you for helping us with this work! We hope that this exercise should take you less than an hour to complete. Please read the instructions below carefully before filling out your responses in the spreadsheet that has been provided to you via email.</p>
<section id="purposeapplication" class="level2">
<h2 class="anchored" data-anchor-id="purposeapplication">Purpose/Application</h2>
<section id="project-context" class="level3">
<h3 class="anchored" data-anchor-id="project-context">Project Context</h3>
<p>There are multiple components of vulnerability to offshore wind energy for seabird species. We have existing tools that help us identify where birds are (i.e., SDMs such as <a href="https://repository.library.noaa.gov/view/noaa/49073">Leirness et al., 2021</a>), how sensitive birds may be to collision or displacement impacts (i.e., vulnerability indices such as Kelsey et al., 2018), and ways of describing bird population status (i.e., IUCN Red List status, state and federal listings, etc). There have also been efforts to combine these metrics in various ways for various purposes, primarily for facility site selection decisions (e.g., the <a href="https://www.boem.gov/boem_2024-015">refinement</a> of the <a href="https://www.boem.gov/renewable-energy/state-activities/Oregon">now-halted</a> wind energy lease areas in Oregon). However, these tools have typically been produced on regional scales – we saw a need to develop a tool that could combine these existing understandings of the components of vulnerability to wind energy development to rank species vulnerability based on the placement of lease areas in any given region developing wind energy. Our primary purpose of the tool is to prioritize species for compensatory mitigation/offsetting projects by understanding which species are most vulnerable to impact, however, by helping categorize species vulnerability for given leases this tool could also be used to prioritize research and monitoring projects. The purpose of this paper is two-fold – my goal is to create an approach to combine these metrics of vulnerability that can be applied to any region developing offshore wind energy, and then demonstrate the application of the tool by using it to provide priority rankings for species in the California Current Ecosystem based on the currently identified offshore wind development areas on the Pacific Outer Continental Shelf (POCS). &nbsp;</p>
</section>
<section id="utility-of-expert-elicitation-exercise" class="level3">
<h3 class="anchored" data-anchor-id="utility-of-expert-elicitation-exercise">Utility of Expert Elicitation Exercise</h3>
<p>We are using the <a href="https://repository.library.noaa.gov/view/noaa/49073">Leirness et al., 2021</a> species distribution maps of seabirds on the POCS to inform how exposed seabirds in the region will be to the proposed wind energy development areas. These models were produced based on bird sighting data from historical surveys and a range of temporal and spatial environmental predictor variables. Models were not produced for any seabird species that had less than 100 transect segments that contained observations in the historical data, meaning that models were not produced for rare species in the California Current Ecosystem. In cases where that is simply because a species’ distribution does not overlap significantly with the POCS region, it is likely fine to leave them out of the prioritization exercise for the region. However, for species of conservation concern that are rare in the region due in part to poor population status, the absence of distribution data creates issues. We are therefore requesting your help in estimating the distributions of three threatened species (Short-tailed Albatross, Hawaiian Petrel, and Townsend’s Storm Petrel) that are found in small numbers in the POCS region so that we may include them in the prioritization exercise.</p>
<p>The Leirness et al.&nbsp;(2021) species distribution maps of seabirds on the Pacific Outer Continental Shelf were produced by season when enough data was present for a given species and season to produce a raster map with an estimate of density per km^2 grid cell. To assess exposure over the course of the entire year, we have combined the models for each season available (assuming a zero presence in seasons not modeled) into an annual model. We then overlay the vector outlines of the wind energy areas under consideration and calculate what proportion much of the summed regional density is found within the development zones. Based on the way that the models are produced and the seasons are combined, this answer cannot be used to predict an actual number of individuals in any given grid cell, but can instead be interpreted as “<em>In seasons that a species is present in the Pacific Outer Continental Shelf region, what proportion of the use of the region for that species overlaps with the development areas</em>”.</p>
<p>To estimate a proportion of the population that overlaps with development areas for Short-tailed Albatross, Hawaiian Petrel, and Townsend’s Storm Petrel using your input on what known species in our dataset we would expect the unknown species to have the most similar distributions to within the POCS region so that we can effectively produce new maps for these species based by weighting and combining existing maps. We will also use the range of answers between experts to produce confidence intervals on those estimates that we can use to convey uncertainty in our estimates.</p>
</section>
</section>
<section id="instructions" class="level2">
<h2 class="anchored" data-anchor-id="instructions">Instructions</h2>
<p>Open the google spreadsheet provided to you in our original email. This is where you’ll provide your answers. For each unknown species column in the spreadsheet, please enter weights (out of 10) for the models provided in the rows to identify which models you think best represent the distribution of the unknown species.</p>
<p>Hypothetical examples:</p>
<p><em>Based on your observations of the Silvery-cheeked Diving Petrel on at-sea surveys, you think it has a relatively coastal distribution with some particularly concentrated distributions around the Columbia River mouth. You list a 7 in the Marbled Murrelet model and a 3 in the Double-crested Cormorant model.</em></p>
<p><em>The Soft-plumaged Skua is critically endangered and you’ve never seen one at sea, but you guess based on your understanding of its life history that when it is found in the POCS region its habitat needs would be most similar to its closest relatives in the region. You list 5 for South Polar Skua, 2.5 for Pomarine Jaeger, and 2.5 for the combined Parasitic and Long-tailed Jaeger model.</em></p>
<p><em>You have absolutely no idea what the distribution of the Fluttering Booby would be within the region. Their distributions and life histories are very poorly understood and you’re no expert. You list a 5 for Laysan Albatross and a 5 for the combined Phalarope Model to try to represent a pretty even density throughout the region since you’re not comfortable making any guesses about where you might expect their population to be concentrated.</em></p>
<p>Important notes:</p>
<ul>
<li><p>For simplicity, the maps provided below have combined any seasonal models that were produced for the species into an annual model (so they effectively represent the averaged annual distribution for each species/group) - we recognize that species distributions will vary dramatically seasonally, but please do your best in providing your answers to try to provide your estimation of the averaged annual distribution for the unknown species.</p></li>
<li><p>Please provide an answer for each of the three unknown species. We recognize that your confidence in your estimates will vary between species, and that’s okay - we’re calculating uncertainty in our final estimates based on the range of the answers provided across experts, and so are hoping to have the same number of expert guesses for each species.</p></li>
<li><p>Please don’t worry about the difference in maximum abundance between species/groups as you’re weighting the models - the way that they’ll be combined won’t factor in abundance, so the maps should just be interpreted as metrics of distribution. On the maps below each grid cell has been rescaled to represent a proportion of the maximum abundance found in any single grid cell for that model so that the maps can be compared directly between one another.</p></li>
</ul>
</section>
<section id="species-maps" class="level2">
<h2 class="anchored" data-anchor-id="species-maps">Species maps</h2>
<p>Note that in some cases distributions are highly concentrated in coastal regions and it makes the visualization of distribution challenging - I recommend zooming in on coastal regions if a map looks blank at a glance.</p>
<section id="combined-scoter-model" class="level3">
<h3 class="anchored" data-anchor-id="combined-scoter-model">Combined Scoter Model</h3>
<p><img src="images/SCOT_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="combined-phalarope-model" class="level3">
<h3 class="anchored" data-anchor-id="combined-phalarope-model">Combined Phalarope Model</h3>
<p><img src="images/PHAL_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="combined-parasitic-long-tailed-jaeger-model" class="level3">
<h3 class="anchored" data-anchor-id="combined-parasitic-long-tailed-jaeger-model">Combined Parasitic &amp; Long-tailed Jaeger Model</h3>
<p><img src="images/PAJA-LTJA_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="pomarine-jaeger" class="level3">
<h3 class="anchored" data-anchor-id="pomarine-jaeger">Pomarine Jaeger</h3>
<p><img src="images/POJA_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="south-polar-skua" class="level3">
<h3 class="anchored" data-anchor-id="south-polar-skua">South Polar Skua</h3>
<p><img src="images/SPSK_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="rhinoceros-auklet" class="level3">
<h3 class="anchored" data-anchor-id="rhinoceros-auklet">Rhinoceros Auklet</h3>
<p><img src="images/RHAU_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="tufted-puffin" class="level3">
<h3 class="anchored" data-anchor-id="tufted-puffin">Tufted Puffin</h3>
<p><img src="images/TUPU_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="cassins-auklet" class="level3">
<h3 class="anchored" data-anchor-id="cassins-auklet">Cassin’s Auklet</h3>
<p><img src="images/CAAU_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="marbled-murrelet" class="level3">
<h3 class="anchored" data-anchor-id="marbled-murrelet">Marbled Murrelet</h3>
<p><img src="images/MAMU_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="pigeon-guillemot" class="level3">
<h3 class="anchored" data-anchor-id="pigeon-guillemot">Pigeon Guillemot</h3>
<p><img src="images/PIGU_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="common-murre" class="level3">
<h3 class="anchored" data-anchor-id="common-murre">Common Murre</h3>
<p><img src="images/COMU_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="ancient-murrelet" class="level3">
<h3 class="anchored" data-anchor-id="ancient-murrelet">Ancient Murrelet</h3>
<p><img src="images/ANMU_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="combined-scripps-guadalupe-craveris-murrelet-model" class="level3">
<h3 class="anchored" data-anchor-id="combined-scripps-guadalupe-craveris-murrelet-model">Combined Scripp’s, Guadalupe, &amp; Craveri’s Murrelet Model</h3>
<p><img src="images/SCMU-GUMU-CRMU_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="black-legged-kittiwake" class="level3">
<h3 class="anchored" data-anchor-id="black-legged-kittiwake">Black-legged Kittiwake</h3>
<p><img src="images/BLKI_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="sabines-gull" class="level3">
<h3 class="anchored" data-anchor-id="sabines-gull">Sabine’s Gull</h3>
<p><img src="images/SAGU_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="bonapartes-gull" class="level3">
<h3 class="anchored" data-anchor-id="bonapartes-gull">Bonaparte’s Gull</h3>
<p><img src="images/BOGU_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="heermanns-gull" class="level3">
<h3 class="anchored" data-anchor-id="heermanns-gull">Heermann’s Gull</h3>
<p><img src="images/HEEG_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="combined-western-glaucous-winged-gull-model" class="level3">
<h3 class="anchored" data-anchor-id="combined-western-glaucous-winged-gull-model">Combined Western &amp; Glaucous-winged Gull Model</h3>
<p><img src="images/WEGU-WGWH-GWGU_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="california-gull" class="level3">
<h3 class="anchored" data-anchor-id="california-gull">California Gull</h3>
<p><img src="images/CAGU_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="combined-herring-iceland-gull-model" class="level3">
<h3 class="anchored" data-anchor-id="combined-herring-iceland-gull-model">Combined Herring &amp; Iceland Gull Model</h3>
<p><img src="images/HERG-ICGU_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="caspian-tern" class="level3">
<h3 class="anchored" data-anchor-id="caspian-tern">Caspian Tern</h3>
<p><img src="images/CATE_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="combined-common-arctic-tern-model" class="level3">
<h3 class="anchored" data-anchor-id="combined-common-arctic-tern-model">Combined Common &amp; Arctic Tern Model</h3>
<p><img src="images/COTE-ARTE_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="combined-royal-elegant-tern-model" class="level3">
<h3 class="anchored" data-anchor-id="combined-royal-elegant-tern-model">Combined Royal &amp; Elegant Tern Model</h3>
<p><img src="images/ROYT-ELTE_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="combined-western-clarks-grebe-model" class="level3">
<h3 class="anchored" data-anchor-id="combined-western-clarks-grebe-model">Combined Western &amp; Clark’s Grebe Model</h3>
<p><img src="images/WEGR-CLGR_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="red-throated-loon" class="level3">
<h3 class="anchored" data-anchor-id="red-throated-loon">Red-throated Loon</h3>
<p><img src="images/RTLO_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="common-loon" class="level3">
<h3 class="anchored" data-anchor-id="common-loon">Common Loon</h3>
<p><img src="images/COLO_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="combined-loon-model-includes-pacific-loon" class="level3">
<h3 class="anchored" data-anchor-id="combined-loon-model-includes-pacific-loon">Combined Loon Model (includes Pacific Loon)</h3>
<p><img src="images/LOON_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="laysan-albatross" class="level3">
<h3 class="anchored" data-anchor-id="laysan-albatross">Laysan Albatross</h3>
<p><img src="images/LAAL_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="black-footed-albatross" class="level3">
<h3 class="anchored" data-anchor-id="black-footed-albatross">Black-footed Albatross</h3>
<p><img src="images/BFAL_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="fork-tailed-storm-petrel" class="level3">
<h3 class="anchored" data-anchor-id="fork-tailed-storm-petrel">Fork-tailed Storm-Petrel</h3>
<p><img src="images/FTSP_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="leachs-storm-petrel" class="level3">
<h3 class="anchored" data-anchor-id="leachs-storm-petrel">Leach’s Storm Petrel</h3>
<p><img src="images/LESP_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="ashy-storm-petrel" class="level3">
<h3 class="anchored" data-anchor-id="ashy-storm-petrel">Ashy Storm-Petrel</h3>
<p><img src="images/ASSP_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="black-storm-petrel" class="level3">
<h3 class="anchored" data-anchor-id="black-storm-petrel">Black Storm-Petrel</h3>
<p><img src="images/BLSP_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="northern-fulmar" class="level3">
<h3 class="anchored" data-anchor-id="northern-fulmar">Northern Fulmar</h3>
<p><img src="images/NOFU_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="murphys-petrel" class="level3">
<h3 class="anchored" data-anchor-id="murphys-petrel">Murphy’s Petrel</h3>
<p><img src="images/MUPE_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="cooks-petrel" class="level3">
<h3 class="anchored" data-anchor-id="cooks-petrel">Cook’s Petrel</h3>
<p><img src="images/COPE_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="pink-footed-shearwater" class="level3">
<h3 class="anchored" data-anchor-id="pink-footed-shearwater">Pink-footed Shearwater</h3>
<p><img src="images/PFSH_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="bullers-shearwater" class="level3">
<h3 class="anchored" data-anchor-id="bullers-shearwater">Buller’s Shearwater</h3>
<p><img src="images/BULS_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="combined-short-tailed-sooty-flesh-footed-shearwater-model" class="level3">
<h3 class="anchored" data-anchor-id="combined-short-tailed-sooty-flesh-footed-shearwater-model">Combined Short-tailed, Sooty, &amp; Flesh-footed Shearwater Model</h3>
<p><img src="images/STTS-SOSH-FFSH_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="black-vented-shearwater" class="level3">
<h3 class="anchored" data-anchor-id="black-vented-shearwater">Black-vented Shearwater</h3>
<p><img src="images/BVSH_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="brandts-cormorant" class="level3">
<h3 class="anchored" data-anchor-id="brandts-cormorant">Brandt’s Cormorant</h3>
<p><img src="images/BRAC_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="pelagic-cormorant" class="level3">
<h3 class="anchored" data-anchor-id="pelagic-cormorant">Pelagic Cormorant</h3>
<p><img src="images/PECO_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="double-crested-cormorant" class="level3">
<h3 class="anchored" data-anchor-id="double-crested-cormorant">Double-crested Cormorant</h3>
<p><img src="images/DCCO_density_map_binned.png" class="img-fluid"></p>
</section>
<section id="brown-pelican" class="level3">
<h3 class="anchored" data-anchor-id="brown-pelican">Brown Pelican</h3>
<p><img src="images/BRPE_density_map_binned.png" class="img-fluid"></p>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>