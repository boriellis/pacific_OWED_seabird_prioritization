<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>index</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


<link rel="stylesheet" href="styles.css">
</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">




<section id="species-prioritization-weight-testing" class="level1">
<h1>Species Prioritization Weight Testing</h1>
<p>The point of this document is to explain each of the steps of the species prioritization framework for the California Current Ecosystem. This document is in progress.</p>
<section id="step-1---selecting-species-present-in-the-region-to-include" class="level2">
<h2 class="anchored" data-anchor-id="step-1---selecting-species-present-in-the-region-to-include">Step 1 - Selecting species present in the region to include</h2>
<p>A literature review was performed to compile a list of all birds found regularly in the region. The initial list was acquired by combining the list from Kelsey et al.&nbsp;(2018) (detailed methods on the list formation can be found in Adams et al., 2016), which identified 81 regional marine bird species in the California Current System, with the list of species modeled by Leirness et al., 2021. The list was then refined according to the following additional criteria:<br>
</p>
<ul>
<li><p>The updated vulnerability index from Kelsey et al (in prep) includes eight additional species due to range shifts and taxonomic updates. We have followed suit and included these species here:</p>
<ul>
<li><p>Masked Booby, <em>Sula dactylatra</em></p>
<p>Nazca Booby, <em>Sula granti</em></p>
<p>Blue-footed Booby, <em>Sula nebouxii</em></p>
<p>Brown Booby, <em>Sula leucogaster</em></p>
<p>Red-footed Booby, <em>Sula sula</em></p>
<p>Red-billed Tropicbird, <em>Phaethon aethereus</em></p>
<p>Guadalupe Murrelet, <em>Synthliboramphus hypoleucus</em></p>
<p>Townsend’s Storm-Petrel, <em>Hydrobates socorroensis</em></p></li>
</ul></li>
<li><p>Species that were considered to have 1% or less of their global population utilizing the CCS by Adams et al 2016 and Kelsey et al 2018 were considered for exclusion from this list, as a metric to exclude vagrants. I have selected the 1% cutoff is based on precedent for use in definitions of <a href="http://datazone.birdlife.org/userfiles/images/Guidelines%20for%20the%20application%20of%20the%20IBA%20criteria_final%20approved%20version_July2020.pdf">Birdlife International’s Important Bird Areas</a>, the <a href="https://ec.europa.eu/environment/nature/natura2000/marine/docs/marine_guidelines.pdf">EU Natura 2000 Site Guidelines for Marine Habitats</a>. It was also used in <a href="https://pubmed.ncbi.nlm.nih.gov/19299065/">Desholm’s 2009</a> prioritization framework for research needs for migratory birds in wind farms. These applications are all for definition of important bird areas at much finer scales than what we’re discussing here, but as I am here recommending that the 1% criteria be used simply as a first step for eliminating vagrants from regional consideration, I believe that it functions in this application as a tool to identify whether the region is important to a species globally.</p>
<ul>
<li>For all species with &lt;1% of global population estimated in the CCS, we performed literature review (primarily through the Cornell Birds of the World database) as a confirmation that the species is appropriate for exclusion. Local population estimates are frequently based on at-sea survey data that may be sufficient to identify certain types of important regional presence. Any species breeding in the CCS was included, even if local populations were small compared to global population sizes. Species known to have migratory pathways crossing the CCS were also included, as a precautionary measure given that brief periods of high bird presence during migration may be challenging to detect from at-sea survey data. Threatened species with poorly understood local area usage were also considered for inclusion.</li>
</ul></li>
</ul>
<p>Following the above steps, of the species that were considered in Leirness et al., 2021, Kelsey et al., 2018, and/or Kelsey et al., 2024, I opted to exclude the following species from this analysis for reasons described below:</p>
<ul>
<li><p><strong>Wilson’s Phalarope, <em>Phalaropus tricolor</em></strong>(Kelsey et al., 2018, 2024: N, Leirness et al., 2021: Y)</p>
<ul>
<li>Not included in original Kelsey et al., vulnerability index as the species does not typically use pelagic habitats. A handful of records from at-sea surveys meant that the species was modeled in the joint “Phalarope” model by Leirness et al., 2021. Excluded here because of very low offshore habitat usage (CITE).</li>
</ul></li>
<li><p><strong>Short-tailed Shearwater, <em>Ardenna tenuirostris</em></strong>(Kelsey et al., 2018, 2024: Y, Leirness et al., 2021: Y)</p>
<ul>
<li><p>&lt;1% of global population considered to be in CCS by Kelsey et al 2018</p></li>
<li><p>Included in joint Short-tailed, Flesh-footed, and Sooty Shearwater model by Leirness et al., 2021, based on low percentages of observations included in the model.</p></li>
<li><p>Excluded because while data on local distribution is poor and outdated, there is no local breeding of the species and no known important migratory route through the CCS, just low usage in the non-breeding season (CITE)..</p></li>
</ul></li>
<li><p><strong>Flesh-footed Shearwater, <em>Ardenna carneipes</em></strong>(Kelsey et al., 2018, 2024: Y, Leirness et al., 2021: Y)</p>
<ul>
<li><p>&lt;1% of global population considered to be in CCS by Kelsey et al 2018</p></li>
<li><p>Included in joint Short-tailed, Flesh-footed, and Sooty Shearwater model by Leirness et al., 2021, based on low percentages of observations included in the model.</p></li>
<li><p>Excluded because while data on local distribution is poor and outdated, there is no local breeding of the species and no known important migratory route through the CCS, just low usage in the non-breeding season (CITE).</p></li>
</ul></li>
<li><p><strong>Arctic Loon, <em>Gavia arctica</em></strong>(Kelsey et al., 2018, 2024: N, Leirness et al., 2021: Y)</p>
<ul>
<li>This was formerly a subspecies of Pacific Loon, and is therefore only included in Leirness et al., 2021 as an artifact of the timing of the split. The species does not use the CCS (CITE).</li>
</ul></li>
<li><p><strong>Common Tern, <em>Sterna hirundo</em></strong>(Kelsey et al., 2018, 2024: Y, Leirness et al., 2021: Y)</p>
<ul>
<li><p>&lt;1% of global population considered to be in CCS by Kelsey et al 2018</p></li>
<li><p>Modeled as part of the Common Tern/Arctic Tern joint model by Leirness et al., 2021</p></li>
<li><p>No breeding populations in the CCS, and no documented important migratory routes through offshore region (CITE).</p></li>
</ul></li>
<li><p><strong>Royal Tern, <em>Thalasseus maximus</em></strong>(Kelsey et al., 2018, 2024: Y, Leirness et al., 2021: Y)</p>
<ul>
<li><p>&lt;1% of global population considered to be in CCS by Kelsey et al 2018</p></li>
<li><p>Modeled as part of the Royal Tern/Elegant Tern joint model by Leirness et al., 2021</p></li>
<li><p>Breeds irregularly in Southern California, but primarily uses inshore habitat; not considered highly pelagic (CITE).</p></li>
</ul></li>
<li><p><strong>Horned Puffin, <em>Fratercula corniculata</em></strong>(Kelsey et al., 2018, 2024: Y, Leirness et al., 2021: N)</p>
<ul>
<li><p>&lt;1% of global population considered to be in CCS by Kelsey et al 2018</p></li>
<li><p>Spend non-breeding season partially in pelagic CCS but not believed to overlap with the CCS in large numbers (CITE)</p></li>
</ul></li>
<li><p><strong>Parakeet Auklet, <em>Aethia psittacula</em></strong>(Kelsey et al., 2018, 2024: Y, Leirness et al., 2021: N)</p>
<ul>
<li><p>&lt;1% of global population considered to be in CCS by Kelsey et al 2018</p></li>
<li><p>Spend non-breeding season partially in pelagic CCS but not believed to overlap with the CCS in large numbers (CITE)</p></li>
</ul></li>
<li><p><strong>Common Merganser, <em>Mergus merganser</em></strong>(Kelsey et al., 2018, 2024: Y, Leirness et al., 2021: N)</p>
<ul>
<li><p>&lt;1% of global population considered to be in CCS by Kelsey et al 2018</p></li>
<li><p>Primarily use inshore and immediate coastal habitat (CITE).</p></li>
</ul></li>
<li><p><strong>Red-breasted Merganser, <em>Mergus serrator</em></strong>(Kelsey et al., 2018, 2024: Y, Leirness et al., 2021: N)</p>
<ul>
<li><p>&lt;1% of global population considered to be in CCS by Kelsey et al 2018</p></li>
<li><p>Primarily use inshore and immediate coastal habitat (CITE).</p></li>
</ul></li>
<li><p><strong>Horned Grebe, <em>Podicepsauritus</em></strong>(Kelsey et al., 2018, 2024: Y, Leirness et al., 2021: N)</p>
<ul>
<li><p>&lt;1% of global population considered to be in CCS by Kelsey et al 2018</p></li>
<li><p>Primarily use inshore and immediate coastal habitat (CITE).</p></li>
</ul></li>
<li><p><strong>Long-tailed Duck, <em>Clangulahyemalis</em></strong>(Kelsey et al., 2018, 2024: Y, Leirness et al., 2021: N)</p>
<ul>
<li>&lt;1% of global population considered to be in CCS by Kelsey et al 2018</li>
</ul></li>
<li><p><strong>Least Storm-Petrel, <em>Hydrobatesmicrosoma</em></strong>(Kelsey et al., 2018, 2024: Y, Leirness et al., 2021: N)</p>
<ul>
<li><p>&lt;1% of global population considered to be in CCS by Kelsey et al 2018</p></li>
<li><p>Occasionally found offshore as far north as central California in late summer but vast majority of population is in Gulf of California (CITE).</p></li>
</ul></li>
<li><p><strong>Gull-billed Tern, <em>Gelochelidonnilotica</em></strong>(Kelsey et al., 2018, 2024: Y, Leirness et al., 2021: N)</p>
<ul>
<li><p>&lt;1% of global population considered to be in CCS by Kelsey et al 2018</p></li>
<li><p>Primarily uses inshore habitat (CITE).</p></li>
</ul></li>
<li><p><strong>Black Tern, <em>Chlidoniasniger</em></strong>(Kelsey et al., 2018, 2024: Y, Leirness et al., 2021: N)</p>
<ul>
<li><p>&lt;1% of global population considered to be in CCS by Kelsey et al 2018</p></li>
<li><p>Primarily uses inshore habitat, not found offshore in CCS (CITE).</p></li>
</ul></li>
<li><p><strong>Wilson’s Storm-Petrel, <em>Oceanitesoceanicus</em></strong>(Kelsey et al., 2018, 2024: Y, Leirness et al., 2021: N)</p>
<ul>
<li><p>&lt;1% of global population considered to be in CCS by Kelsey et al 2018</p></li>
<li><p>Uncommonly found in CCS in non-breeding season (CITE).</p></li>
</ul></li>
<li><p><strong>American White Pelican, <em>Pelecanuserythrorhynchos</em></strong>(Kelsey et al., 2018, 2024: Y, Leirness et al., 2021: N)</p>
<ul>
<li><p>&lt;1% of global population considered to be in CCS by Kelsey et al 2018</p></li>
<li><p>Not found in offshore habitat (CITE).</p></li>
</ul></li>
<li><p><strong>Manx Shearwater, <em>Puffinuspuffinus</em></strong>(Kelsey et al., 2018, 2024: Y, Leirness et al., 2021: N)</p>
<ul>
<li><p>&lt;1% of global population considered to be in CCS by Kelsey et al 2018</p></li>
<li><p>Doesn’t breed in region, only rarely found offshore (CITE).</p></li>
</ul></li>
</ul>
<p>The following species were included in the analysis despite a global population overlap with the CCS estimated by Kelsey et al., 2018 to be &lt;1%, for the reasons stated:</p>
<ul>
<li><p><strong>Hawaiian Petrel, <em>Pterodromasandwichensis</em></strong>(Kelsey et al., 2018, 2024: Y, Leirness et al., 2021: N)</p>
<ul>
<li>Included to be precautionary because of endangered IUCN status and an abundance of eBird sightings in recent years (CITE).</li>
</ul></li>
<li><p><strong>Fork-tailed Storm Petrel, <em>Hydrobatesfurcatus</em></strong>(Kelsey et al., 2018, 2024: Y, Leirness et al., 2021: Y)</p>
<ul>
<li>Included because the species breeds in the CCS (CITE).</li>
</ul></li>
<li><p><strong>Parasitic Jaeger, <em>Stercorarius parasiticus</em></strong>(Kelsey et al., 2018, 2024: Y, Leirness et al., 2021: Y)</p>
<ul>
<li>Understood to migrate through the CCS, but limited research on movement and abundance data throughout the region (CITE) - included to be precautionary as migratory movements may be challenging to pick up in at-sea survey data.</li>
</ul></li>
<li><p><strong>Black Storm Petrel, <em>Hydrobates melania</em></strong>(Kelsey et al., 2018, 2024: Y, Leirness et al., 2021: Y)</p>
<ul>
<li>Included because the species breeds in the CCS (CITE).</li>
</ul></li>
<li><p><strong>Laysan Albatross, <em>Phoebastria immutabilis</em></strong>(Kelsey et al., 2018, 2024: Y, Leirness et al., 2021: Y)</p>
<ul>
<li>Included precautionarily given breeding population on Guadalupe Island and given proposed translocation to establish breeding colonies on the Channel Islands (Raine et al., 2022)</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#loading up packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>packages<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tidyverse"</span>, <span class="st">"here"</span>, <span class="st">"dplyr"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(packages, <span class="at">character.only =</span> <span class="cn">TRUE</span>); <span class="fu">rm</span>(packages)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Part 2: Import and Clean Data -----------------------------------------------</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#load in csvs</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>densities <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/processed_data/raw_density_outputs.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
Rows: 46 Columns: 9
── Column specification
──────────────────────────────────────────────────────── Delimiter: "," chr
(1): ...1 dbl (8): totdens_OCSP0561, totdens_OCSP0562, totdens_OCSP0563,
totdens_OCSP0...
ℹ Use `spec()` to retrieve the full column specification for this data. ℹ
Specify the column types or set `show_col_types = FALSE` to quiet this message.
• `` -&gt; `...1`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>masterlist <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/raw_data/allspp_iucnstatus.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 94 Columns: 19
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (15): alpha_code, taxonomy, common_name, scientific_name, regional, why?...
dbl  (3): pct_in_CCS_Lower, pct_in_CCS_Upper, CCSpop_Score
lgl  (1): CACurrent_breeding

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>CV <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/raw_data/sensitivity/POCS_VulnIndex_update2023_CV.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 89 Columns: 53
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (7): Taxonomy, Common_Name, AlphaCode, Scientific_Name, FA_Reference, R...
dbl (46): TaxNumCl_2023, NFA_new, NFA_min, NFA_max, NFA_Score, NFA_Uncertain...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>DV <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/raw_data/sensitivity/POCS_VulnIndex_update2023_DV.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 89 Columns: 27
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (6): Taxonomy, Common_Name, AlphaCode, Scientific_Name, MA_Reference, H...
dbl (21): TaxNumCl_2023, MA_new, MA_min, MA_max, MA_litSourceNo, MA_litSourc...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#select species from masterlist that we consider "out of region"</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>excluded <span class="ot">&lt;-</span> masterlist <span class="sc">%&gt;%</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(regional <span class="sc">==</span> <span class="st">"N"</span>)    <span class="co">#filter only the species we don't consider "in the region"</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">#clean densities</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>cleandensities <span class="ot">&lt;-</span> densities <span class="sc">%&gt;%</span> </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">exposure_model=</span>...<span class="dv">1</span>) <span class="sc">%&gt;%</span>  <span class="co">#rename first col</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#add new columns for proportions in given regions</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">propOR =</span> ((totdens_OCSP0566 <span class="sc">+</span> totdens_OCSP0567)<span class="sc">/</span>totdens_region), <span class="co">#proportion that overlaps with OR call areas</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">propCA =</span> ((totdens_OCSP0561 <span class="sc">+</span> totdens_OCSP0562 <span class="sc">+</span> totdens_OCSP0563 <span class="sc">+</span> totdens_OCSP0564 <span class="sc">+</span> totdens_OCSP0565 )<span class="sc">/</span>totdens_region), <span class="co">#proportion that overlaps with CA leases</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">propALL =</span> ((totdens_OCSP0561 <span class="sc">+</span> totdens_OCSP0562 <span class="sc">+</span> totdens_OCSP0563 <span class="sc">+</span> totdens_OCSP0564 <span class="sc">+</span> totdens_OCSP0565 <span class="sc">+</span> totdens_OCSP0566 <span class="sc">+</span> totdens_OCSP0567)<span class="sc">/</span>totdens_region)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>           ) <span class="sc">%&gt;%</span> </span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(exposure_model, propOR, propCA, propALL) <span class="co">#select only proportion columns</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co">#clean sensitivities and combine</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>cleanCV <span class="ot">&lt;-</span> CV <span class="sc">%&gt;%</span> <span class="co">#collision vulnerability</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">alpha_code =</span> AlphaCode,</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">CV =</span> CV_new) </span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>cleanDV <span class="ot">&lt;-</span> DV <span class="sc">%&gt;%</span> <span class="co"># displacement vulnerability</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">alpha_code =</span> AlphaCode,</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">DV =</span> DV_new)</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>cleansensitivity <span class="ot">&lt;-</span> cleanCV <span class="sc">%&gt;%</span> <span class="co">#combine into one </span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(cleanDV, <span class="at">by =</span> <span class="st">"alpha_code"</span>)</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="co">#combine desired data into single dataframe</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>excluded_alldat <span class="ot">&lt;-</span> excluded <span class="sc">%&gt;%</span> </span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(cleandensities, <span class="at">by =</span> <span class="st">"exposure_model"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(cleansensitivity, <span class="at">by =</span> <span class="st">"alpha_code"</span>)</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a><span class="co">#print it</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>excluded_alldat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 18 × 24
   alpha_code taxonomy              common_name scientific_name pct_in_CCS_Lower
   &lt;chr&gt;      &lt;chr&gt;                 &lt;chr&gt;       &lt;chr&gt;                      &lt;dbl&gt;
 1 WIPH       Scolopacidae (Sandpi… Wilson's P… Phalaropus tri…            NA   
 2 STTS       Procellariidae (Petr… Short-tail… Ardenna tenuir…             0.04
 3 FFSH       Procellariidae (Petr… Flesh-foot… Ardenna carnei…            NA   
 4 ARLO       Gaviidae (Loons)      Arctic Loon Gavia arctica              NA   
 5 COTE       Laridae (Gulls, Tern… Common Tern Sterna hirundo              0.26
 6 ROYT       Laridae (Gulls, Tern… Royal Tern  Thalasseus max…             0.14
 7 HOPU       Alcidae (Auks)        Horned Puf… Fratercula cor…             0.42
 8 PAAU       Alcidae (Auks)        Parakeet A… Aethia psittac…            NA   
 9 COME       Anatidae (Ducks, Gee… Common Mer… Mergus mergans…            NA   
10 RBME       Anatidae (Ducks, Gee… Red-breast… Mergus serrator             0.23
11 HOGR       Anatidae (Ducks, Gee… Horned Gre… Podiceps aurit…             0.16
12 LTDU       Anatidae (Ducks, Gee… Long-taile… Clangula hyema…            NA   
13 LSTP       Hydrobatidae (Northe… Least Stor… Hydrobates mic…            NA   
14 GBTE       Laridae (Gulls, Tern… Gull-bille… Gelochelidon n…             0.02
15 BLTE       Laridae (Gulls, Tern… Black Tern  Chlidonias nig…             0   
16 WISP       Oceanatidae (Souther… Wilson's S… Oceanites ocea…             1   
17 AWPE       Pelecanidae (Pelican… American W… Pelecanus eryt…            50   
18 MASH       Procellariidae (Petr… Manx Shear… Puffinus puffi…            NA   
# ℹ 19 more variables: pct_in_CCS_Upper &lt;dbl&gt;, CCSpop_Score &lt;dbl&gt;,
#   CACurrent_breeding &lt;lgl&gt;, regional &lt;chr&gt;, `why?` &lt;chr&gt;,
#   exposure_model &lt;chr&gt;, iucn_status &lt;chr&gt;, iucn_trend &lt;chr&gt;, ESA &lt;chr&gt;,
#   CA_status &lt;chr&gt;, OR_status &lt;chr&gt;, WA_status &lt;chr&gt;, NOM_059_ECOL_2001 &lt;chr&gt;,
#   COSEWIC &lt;chr&gt;, propOR &lt;dbl&gt;, propCA &lt;dbl&gt;, propALL &lt;dbl&gt;, CV &lt;dbl&gt;,
#   DV &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>